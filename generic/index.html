<!doctype html>
<html>
  <head>
    <title>Fin ZD demo</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>

    <script>
      function reset() {
        const cookies = document.cookie.split(";");

        for (let i = 0; i < cookies.length; i++) {

            const cookie = cookies[i];

            const eqPos = cookie.indexOf("=");

            const name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;

            // Set the cookie's expiration date to a past date to delete it

            document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/";

        }

        window.localStorage.clear();
        window.sessionStorage.clear();
        window.location.reload();
        if (window.Intercom) {
          window.Intercom('shutdown');

        }

      }
    </script>
  </head>
  <body class="p-6 flex flex-col flex-1 items-center justify-center min-h-screen bg-cover" style="background-image: url('https://downloads.intercomcdn.com/i/o/1051523575/8c16c6bb97ae791131ead20c/blur.jpg')">
    <div class="flex flex-col space-y-2 items-center">
      <div>
        <img src="https://static.intercomassets.com/assets/default-avatars/fin/128-6a5eabbb84cc2b038b2afc6698ca0a974faf7adc9ea9f0fb3c3e78ac12543bc5.png" height="50" width="50"  >
      </div>
      <button class="bg-black text-white p-2 m-2 rounded hover:bg-opacity-75" onclick="reset()">Reset</button>
    </div>
    <script>
      window.intercomSettings = {
        api_base: "https://api-iam.intercom.io",
        app_id: "q44qconr",
        handoff_with_javascript: async() => {
          console.log('handing off with javascript');
          Intercom('shutdown');
          await zE('messenger', 'show');
          await zE('messenger:set', 'conversationFields', [{ id: 30684896874386, value: '7654321' }])
          await zE('messenger', 'open');


          await new Promise(resolve => setTimeout(resolve, 2000));
          let composer = document.querySelector('iframe[name="Messaging window"]').contentDocument.querySelector('textarea#composer-input');

          let setter = Object.getOwnPropertyDescriptor(
            composer.ownerDocument.defaultView.HTMLTextAreaElement.prototype,
            'value'
          ).set;

          setter.call(composer, 'Imagine this was the transcript');

          composer.dispatchEvent(new Event('input', { bubbles: true }));
          
          await new Promise(resolve => setTimeout(resolve, 500));

          document.querySelector('iframe[name="Messaging window"]').contentDocument.querySelector('button[aria-label="Send message"]').click()
        }
      }

      document.addEventListener('DOMContentLoaded', () => {
        console.log('DOMContentLoaded');
        zE('messenger', 'hide');
      });
    </script>


    <script>
      // We pre-filled your app ID in the widget URL: 'https://widget.intercom.io/widget/q44qconr'
      (function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/q44qconr';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(document.readyState==='complete'){l();}else if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
    </script>


    <!-- Start of Generic Zendesk Widget script -->
    <script id="ze-snippet" src="https://static.zdassets.com/ekr/snippet.js?key=ee12db3b-1ab8-481e-9cfa-0023414f2faf"> </script>
    <!-- End of Generic Zendesk Widget script -->

  
  </body>
</html>